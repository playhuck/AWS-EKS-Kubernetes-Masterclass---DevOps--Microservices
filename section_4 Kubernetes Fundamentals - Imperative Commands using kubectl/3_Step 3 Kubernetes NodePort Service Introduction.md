- **Step 3 Kubernetes NodePort Service Introduction**
    
    
    Kubernetes의 핵심 개념 중 하나인 Service에 대해서 알아볼건 데 그 중에서도 특히 NodePort 서비스에 중점을 둔다.
    
    Pods 데모에서 이 개념을 조기에 도입하는 이유는, 배포한 Pod를 실제로 테스트하고 접근해보지 않는다면 Application에서 동작이 어떻게 일어나는지 알기 어렵기 때문에 파드에 테스트 하고 접근할 수 있는 방법을 다루는 것 이다.
    
    Kubernetes에서는 외부에 앱을 노출하기 위해 여러 서비스를 제공한다. 이러한 서비스들은 아래와 같다.
    
    - Cluster IP : 
    
    클러스터 내부에서만 접근할 수 있는 서비스다. 클러스터 내부에서만 포트를 통해 접근할 수 있다.
    
    - NodePort :
    
    워커 노드의 포트를 통해 외부에서 앱에 접근할 수 있도록 도와주는 서비스다. NodePort 서비스는 각 워커 노드의 IP와 특정 Port에서 서비스를 노출한다. 각 포트 범위는 30,000 - 32,767
    
    k8s 클러스터 외부에서 우리 서비스에 접근하기 위해, 노드포트 서비스를 사용할 수 있다. 일련의 정적인 포트 값을 통해, 워커 노드의 Ip를 서비스가 노출합니다.
    - LoadBalancer :
    
    클라우드 밴더와 통합되어 자동으로 생성된다.
    
    ### NodePort Service Flow
    
    예를 들어, my-first-pod라는 이름의 파드를 배포했다고 하면
    
    - Clusetr Port : 파드는 Cluster IP 서비스를 통해 클러스터 내부에서 접근할 수 있다. 일반적으로 Cluster IP의 포트는 80이다.
    - Target Port : NodePort 서비스는 포트를 30,000 ~ 32,767 사이에서 할당한다. 이 포트는 클러스터 외부에서 접근할 수 있도록 한다. kubectl을 통해 NodePort를 생성할 때 포트 번호는 자동 할당된다. yaml을 사용해 선언적 방식으로 포트 번호를 지정할 수 있다.
    - 요청이 워커노드 NodePort를 통해 들어오면 ⇒ NodePort 서비스는 이를 Cluster IP:80으로 전달한다. ⇒ Cluster IP 서비스는 이를 다시 파드의 컨테이너 포트(:8080 등)으로 접근하여 앱에 접근할 수 있도록 합니다.
    
    이런 일련의 과정을 통해 외부에서 파드로 접근할 수 있도록 합니다.